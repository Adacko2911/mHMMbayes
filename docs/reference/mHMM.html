<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='mHMM fits a multilevel (also known as mixed or random effects) hidden
Markov model (HMM) to intense longitudinal data with categorical observations
of multiple subjects using Bayesian estimation, and creates an object of
class mHMM. By using a multilevel framework, we allow for heterogeneity in
the model parameters between subjects, while estimating one overall HMM. The
function includes the possibility to add covariates at level 2 (i.e., at the
subject level) and have varying observation lengths over subjects. For a
short description of the package see mHMMbayes. See
vignette("tutorial-mhmm") for an introduction to multilevel hidden
Markov models and the package, and see vignette("estimation-mhmm") for
an overview of the used estimation algorithms.'><title>Multilevel hidden  Markov model using Bayesian estimation — mHMM • mHMMbayes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multilevel hidden  Markov model using Bayesian estimation — mHMM"><meta property="og:description" content='mHMM fits a multilevel (also known as mixed or random effects) hidden
Markov model (HMM) to intense longitudinal data with categorical observations
of multiple subjects using Bayesian estimation, and creates an object of
class mHMM. By using a multilevel framework, we allow for heterogeneity in
the model parameters between subjects, while estimating one overall HMM. The
function includes the possibility to add covariates at level 2 (i.e., at the
subject level) and have varying observation lengths over subjects. For a
short description of the package see mHMMbayes. See
vignette("tutorial-mhmm") for an introduction to multilevel hidden
Markov models and the package, and see vignette("estimation-mhmm") for
an overview of the used estimation algorithms.'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mHMMbayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/online_only/get_started.html">Getting started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and data</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/online_only/tutorial-mhmm.html">Tutorial mHMM</a>
    <a class="dropdown-item" href="../articles/online_only/estimation-mhmm.html">Estimation of mHMM</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/emmekeaarts/mHMMbayes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multilevel hidden  Markov model using Bayesian estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/emmekeaarts/mHMMbayes/blob/HEAD/R/mHMM.R" class="external-link"><code>R/mHMM.R</code></a></small>
      <div class="d-none name"><code>mHMM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mHMM</code> fits a multilevel (also known as mixed or random effects) hidden
Markov model (HMM) to intense longitudinal data with categorical observations
of multiple subjects using Bayesian estimation, and creates an object of
class mHMM. By using a multilevel framework, we allow for heterogeneity in
the model parameters between subjects, while estimating one overall HMM. The
function includes the possibility to add covariates at level 2 (i.e., at the
subject level) and have varying observation lengths over subjects. For a
short description of the package see <a href="mHMMbayes.html">mHMMbayes</a>. See
<code><a href="../articles/online_only/tutorial-mhmm.html">vignette("tutorial-mhmm")</a></code> for an introduction to multilevel hidden
Markov models and the package, and see <code><a href="../articles/estimation-mhmm.html">vignette("estimation-mhmm")</a></code> for
an overview of the used estimation algorithms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mHMM</span><span class="op">(</span></span>
<span>  <span class="va">s_data</span>,</span>
<span>  <span class="va">gen</span>,</span>
<span>  xx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">start_val</span>,</span>
<span>  <span class="va">mcmc</span>,</span>
<span>  return_path <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">print_iter</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gamma_hyp_prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  emiss_hyp_prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gamma_sampler <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  emiss_sampler <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>s_data</dt>
<dd><p>A matrix containing the observations to be modeled, where the
rows represent the observations over time. In <code>s_data</code>, the first
column indicates subject id number. Hence, the id number is repeated over
rows equal to the number of observations for that subject. The subsequent
columns contain the dependent variable(s). Note that the dependent
variables have to be numeric, i.e., they cannot be a (set of) factor
variable(s). The total number of rows are equal to the sum over the number
of observations of each subject, and the number of columns are equal to the
number of dependent variables (<code>n_dep</code>) + 1. The number of
observations can vary over subjects.</p></dd>


<dt>gen</dt>
<dd><p>List containing the following elements denoting the general model
properties:</p><ul><li><p><code>n_dep</code>: numeric vector with length 1 denoting the
number of dependent variables</p></li>
<li><p><code>q_emiss</code>: numeric vector with length <code>n_dep</code> denoting the
number of observed categories for the categorical emission distribution
for each of the dependent variables.</p></li>
</ul></dd>


<dt>xx</dt>
<dd><p>An optional list of (level 2) covariates to predict the transition
  matrix and/or the emission probabilities. Level 2 covariate(s) means that
  there is one observation per subject of each covariate. The first element
  in the list <code>xx</code> is used to predict the transition matrix. Subsequent
  elements in the list are used to predict the emission distribution of (each
  of) the dependent variable(s). Each element in the list is a matrix, with
  the number of rows equal to the number of subjects. The first column of
  each matrix represents the intercept, that is, a column only consisting of
  ones. Subsequent columns correspond to covariates used to predict the
  transition matrix / emission distribution. See <em>Details</em> for more
  information on the use of covariates.</p>
<p>If <code>xx</code> is omitted completely, <code>xx</code> defaults to <code>NULL</code>,
  resembling no covariates. Specific elements in the list can also be left
  empty (i.e., set to <code>NULL</code>) to signify that either the transition
  probability matrix or a specific emission distribution is not predicted by
  covariates.</p></dd>


<dt>start_val</dt>
<dd><p>List containing the start values for the transition
probability matrix gamma and the emission distribution(s). The first
element of the list contains a <code>m</code> by <code>m</code> matrix with the start
values for gamma. The subsequent elements contain <code>m</code> by
<code>q_emiss[k]</code> matrices for the start values for each of the <code>k</code> in
<code>n_dep</code> emission distribution(s). Note that <code>start_val</code> should not contain
nested lists (i.e., lists within lists).</p></dd>


<dt>mcmc</dt>
<dd><p>List of Markov chain Monte Carlo (MCMC) arguments, containing the
following elements:</p><ul><li><p><code>burn_in</code>: numeric vector with length 1 denoting the
burn-in period for the MCMC algorithm.</p></li>
</ul></dd>


<dt>return_path</dt>
<dd><p>A logical scalar. Should the sampled state sequence
obtained at each iteration and for each subject be returned by the function
(<code>sample_path = TRUE</code>) or not (<code>sample_path = FALSE</code>). Note that
the sampled state sequence is quite a large object, hence the default
setting is <code>sample_path = FALSE</code>. Can be used for local decoding
purposes.</p></dd>


<dt>print_iter</dt>
<dd><p>The argument print_iter is deprecated; please use
<code>show_progress</code> instead to show the progress of the algorithm.</p></dd>


<dt>show_progress</dt>
<dd><p>A logical scaler. Should the function show a text
progress bar in the <code>R</code> console to represent the progress of the
algorithm (<code>show_progress = TRUE</code>) or not (<code>show_progress =
FALSE</code>). Defaults to <code>show_progress = TRUE</code>.</p></dd>


<dt>gamma_hyp_prior</dt>
<dd><p>An optional object of class <code>mHMM_prior_gamma</code>
containing user specified parameter values for the hyper-prior distribution
on the transition probability matrix gamma, generated by the function
<code><a href="prior_gamma.html">prior_gamma</a></code>.</p></dd>


<dt>emiss_hyp_prior</dt>
<dd><p>An optional object of the class
<code>mHMM_prior_emiss</code> containing user specified parameter values for the
hyper-prior distribution on categorical the emission distribution,
generated by the function <code><a href="prior_emiss_cat.html">prior_emiss_cat</a></code>.</p></dd>


<dt>gamma_sampler</dt>
<dd><p>An optional object of the class <code>mHMM_pdRW_gamma</code>
containing user specified settings for the proposal distribution of the
random walk (RW) Metropolis sampler on the subject level transition
probability matrix parameters, generated by the function
<code><a href="pd_RW_gamma.html">pd_RW_gamma</a></code>.</p></dd>


<dt>emiss_sampler</dt>
<dd><p>An optional object of the class <code>mHMM_pdRW_emiss</code>
containing user specified settings for the proposal distribution of the
random walk (RW) Metropolis sampler on the subject level emission
distribution(s) parameters, generated by the function
<code><a href="pd_RW_emiss_cat.html">pd_RW_emiss_cat</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>mHMM</code> returns an object of class <code>mHMM</code>, which has</p>
<p></p>
<p><code>print</code> and <code>summary</code> methods to see the results.
  The object contains the following components:</p>
<p></p>
<dl><dt><code>PD_subj</code></dt>
<dd><p>A list containing one matrix per subject with the
  subject level parameter estimates and the log likelihood over the
  iterations of the hybrid Metropolis within Gibbs sampler. The iterations of
  the sampler are contained in the rows, and the columns contain the subject
  level (parameter) estimates of subsequently the emission probabilities, the
  transition probabilities and the log likelihood.</p></dd>

  <dt><code>gamma_prob_bar</code></dt>
<dd><p>A matrix containing the group level parameter
  estimates of the transition probabilities over the iterations of the hybrid
  Metropolis within Gibbs sampler. The iterations of the sampler are
  contained in the rows, and the columns contain the group level parameter
  estimates. If covariates were included in the analysis, the group level
  probabilities represent the predicted probability given that the covariate
  is at the average value for continuous covariates, or given that the
  covariate equals zero for dichotomous covariates.</p></dd>

  <dt><code>gamma_int_bar</code></dt>
<dd><p>A matrix containing the group level intercepts
  of the Multinomial logistic regression modeling the transition
  probabilities over the iterations of the hybrid Metropolis within Gibbs
  sampler. The iterations of the sampler are contained in the rows, and the
  columns contain the group level intercepts.</p></dd>

  <dt><code>gamma_cov_bar</code></dt>
<dd><p>A matrix containing the group level regression
  coefficients of the Multinomial logistic regression predicting the
  transition probabilities over the iterations of the hybrid Metropolis within
  Gibbs sampler. The iterations of the sampler are contained in the rows, and
  the columns contain the group level regression coefficients.</p></dd>

  <dt><code>gamma_int_subj</code></dt>
<dd><p>A list containing one matrix per subject
  denoting the subject level intercepts of the Multinomial logistic
  regression modeling the transition probabilities over the iterations of the
  hybrid Metropolis within Gibbs sampler. The iterations of the sampler are
  contained in the rows, and the columns contain the subject level
  intercepts.</p></dd>

  <dt><code>gamma_naccept</code></dt>
<dd><p>A matrix containing the number of accepted
  draws at the subject level RW Metropolis step for each set of parameters of
  the transition probabilities. The subjects are contained in the rows, and
  the columns contain the sets of parameters.</p></dd>

  <dt><code>emiss_prob_bar</code></dt>
<dd><p>A list containing one matrix per dependent
  variable, denoting the group level emission probabilities of each dependent
  variable over the iterations of the hybrid Metropolis within Gibbs sampler.
  The iterations of the sampler are contained in the rows of the matrix, and
  the columns contain the group level emission probabilities. If covariates
  were included in the analysis, the group level probabilities represent the
  predicted probability given that the covariate is at the average value for
  continuous covariates, or given that the covariate equals zero for
  dichotomous covariates.</p></dd>

  <dt><code>emiss_int_bar</code></dt>
<dd><p>A list containing one matrix per dependent
  variable, denoting the group level intercepts of each dependent variable of
  the Multinomial logistic regression modeling the probabilities of the
  emission distribution over the iterations of the hybrid Metropolis within
  Gibbs sampler. The iterations of the sampler are contained in the rows of
  the matrix, and the columns contain the group level intercepts.</p></dd>

  <dt><code>emiss_cov_bar</code></dt>
<dd><p>A list containing one matrix per dependent
  variable, denoting the group level regression coefficients of the
  Multinomial logistic regression predicting the emission probabilities within
  each of the dependent variables over the iterations of the hybrid
  Metropolis within Gibbs sampler. The iterations of the sampler are
  contained in the rows  of the matrix, and the columns contain the group
  level regression coefficients.</p></dd>

  <dt><code>emiss_int_subj</code></dt>
<dd><p>A list containing one list per subject denoting
  the subject level intercepts of each dependent variable of the Multinomial
  logistic regression modeling the probabilities of the emission distribution
  over the iterations of the hybrid Metropolis within Gibbs sampler. Each
  lower level list contains one matrix per dependent variable, in which
  iterations of the sampler are contained in the rows, and the columns
  contain the subject level intercepts.</p></dd>

  <dt><code>emiss_naccept</code></dt>
<dd><p>A list containing one matrix per dependent
  variable with the number of accepted draws at the subject level RW
  Metropolis step for each set of parameters of the emission distribution.
  The subjects are contained in the rows, and the columns of the matrix
  contain the sets of parameters.</p></dd>

  <dt><code>input</code></dt>
<dd><p>Overview of used input specifications: the number of
  states <code>m</code>, the number of used dependent variables <code>n_dep</code>, the
  number of output categories for each of the dependent variables
  <code>q_emiss</code>, the number of iterations <code>J</code> and the specified burn in
  period <code>burn_in</code> of the hybrid Metropolis within Gibbs sampler, the
  number of subjects <code>n_subj</code>, the observation length for each subject
  <code>n_vary</code>, and the column names of the dependent variables
  <code>dep_labels</code>.</p></dd>

  <dt><code>sample_path</code></dt>
<dd><p>A list containing one matrix per subject with the
  sampled hidden state sequence over the hybrid Metropolis within Gibbs
  sampler. The time points of the dataset are contained in the rows, and the
  sampled paths over the iterations are contained in the columns. Only
  returned if <code>return_path = TRUE</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Covariates specified in <code>xx</code> can either be dichotomous or continuous
variables. Dichotomous variables have to be coded as 0/1 variables.
Categorical or factor variables can as yet not be used as predictor
covariates. The user can however break up the categorical variable in
multiple dummy variables (i.e., dichotomous variables), which can be used
simultaneously in the analysis. Continuous predictors are automatically
centered. That is, the mean value of the covariate is subtracted from all
values of the covariate such that the new mean equals zero. This is done such
that the presented probabilities in the output (i.e., for the population
transition probability matrix and population emission probabilities)
correspond to the predicted probabilities at the average value of the
covariate(s).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rabiner LR (1989).
“A tutorial on hidden Markov models and selected applications in speech recognition.”
<em>Proceedings of the IEEE</em>, <b>77</b>(2), 257--286.</p>
<p>Scott SL (2002).
“Bayesian methods for hidden Markov models: Recursive computing in the 21st century.”
<em>Journal of the American Statistical Association</em>, <b>97</b>(457), 337--351.</p>
<p>Altman RM (2007).
“Mixed hidden Markov models: an extension of the hidden Markov model to the longitudinal data setting.”
<em>Journal of the American Statistical Association</em>, <b>102</b>(477), 201--210.</p>
<p>Rossi PE, Allenby GM, McCulloch R (2012).
<em>Bayesian statistics and marketing</em>.
John Wiley &amp; Sons.</p>
<p>Zucchini W, MacDonald IL, Langrock R (2017).
<em>Hidden Markov models for time series: an introduction using R</em>.
Chapman and Hall/CRC.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sim_mHMM.html">sim_mHMM</a></code> for simulating multilevel hidden Markov data,
  <code><a href="vit_mHMM.html">vit_mHMM</a></code> for obtaining the most likely hidden state sequence
  for each subject using the Viterbi algorithm, <code><a href="obtain_gamma.html">obtain_gamma</a></code>
  and <code><a href="obtain_emiss.html">obtain_emiss</a></code> for obtaining the transition or emission
  distribution probabilities of a fitted model at the group or subject level,
  and <code><a href="plot.mHMM.html">plot.mHMM</a></code> for plotting the posterior densities of a
  fitted model.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###### Example on package example data, see ?nonverbal</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># specifying general model properties:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">n_dep</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">q_emiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specifying starting values</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.2</span></span></span>
<span class="r-in"><span><span class="va">start_EM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="co"># looking patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing therapist</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># looking therapist</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run a model without covariate(s):</span></span></span>
<span class="r-in"><span><span class="co"># Note that for reasons of running time, J is set at a ridiculous low value.</span></span></span>
<span class="r-in"><span><span class="co"># One would typically use a number of iterations J of at least 1000,</span></span></span>
<span class="r-in"><span><span class="co"># and a burn_in of 200.</span></span></span>
<span class="r-in"><span><span class="va">out_2st</span> <span class="op">&lt;-</span> <span class="fu">mHMM</span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>,</span></span>
<span class="r-in"><span>                gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">11</span>, burn_in <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:07</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out_2st</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 iterations used in the MCMC algorithm with a burn in of 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average Log likelihood over all subjects: -1638.898 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average AIC over all subjects: 3305.797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of states used: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of dependent variables used: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_2st</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State transition probability matrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              To state 1 To state 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 1      0.957      0.043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 2      0.094      0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Emission distribution for each of the dependent variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.034      0.925      0.041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.759      0.109      0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1       0.24       0.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2       0.10       0.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.775      0.128      0.098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.038      0.935      0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.058      0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.280      0.720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the posterior densities for the transition and emission probabilities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_2st</span>, component <span class="op">=</span> <span class="st">"gamma"</span>, col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkslategray3"</span>, <span class="st">"goldenrod"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mHMM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run a model including a covariate (see ?nonverbal_cov) to predict the</span></span></span>
<span class="r-in"><span><span class="co"># emission distribution for each of the 4 dependent variables:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_subj</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">xx_emiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_subj</span><span class="op">)</span>,<span class="va">nonverbal_cov</span><span class="op">$</span><span class="va">std_CDI_change</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="va">n_subj</span><span class="op">)</span><span class="op">)</span>, <span class="va">n_dep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">n_subj</span><span class="op">)</span><span class="op">)</span>, <span class="va">xx_emiss</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_2st_c</span> <span class="op">&lt;-</span> <span class="fu">mHMM</span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>, xx <span class="op">=</span> <span class="va">xx</span>,</span></span>
<span class="r-in"><span>                  gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">11</span>, burn_in <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co">###### Example on simulated data</span></span></span>
<span class="r-in"><span><span class="co"># Simulate data for 10 subjects with each 100 observations:</span></span></span>
<span class="r-in"><span><span class="va">n_t</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">n_dep</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">q_emiss</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>                  <span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">m</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.8</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_mHMM.html">sim_mHMM</a></span><span class="op">(</span>n_t <span class="op">=</span> <span class="va">n_t</span>, n <span class="op">=</span> <span class="va">n</span>, gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  gamma <span class="op">=</span> <span class="va">gamma</span>, emiss_distr <span class="op">=</span> <span class="va">emiss_distr</span>, var_gamma <span class="op">=</span> <span class="fl">.5</span>, var_emiss <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify remaining required analysis input (for the example, we use simulation</span></span></span>
<span class="r-in"><span><span class="co"># input as starting values):</span></span></span>
<span class="r-in"><span><span class="va">n_dep</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">q_emiss</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the model on the simulated data:</span></span></span>
<span class="r-in"><span><span class="va">out_2st_sim</span> <span class="op">&lt;-</span> <span class="fu">mHMM</span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">obs</span>,</span></span>
<span class="r-in"><span>                 gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span>, <span class="va">emiss_distr</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">11</span>, burn_in <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="xxx">Emmeke Aarts</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

