<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="prior_emiss_cat provides a framework to manually specify an informative
hyper-prior on the categorical emission distribution(s), and creates an object
of class mHMM_prior_emiss used by the function mHMM. Note that the
hyper-prior distribution on the categorical emission probabilities are on the
intercepts (and, if subject level covariates are used, regression
coefficients) of the Multinomial logit model used to accommodate the
multilevel framework of the data, instead of on the probabilities directly.
The set of hyper-prior distributions consists of a multivariate Normal
hyper-prior distribution on the vector of means (i.e., intercepts and
regression coefficients), and an Inverse Wishart hyper-prior distribution on
the covariance matrix."><title>Specifying informative hyper-prior on the categorical emission distribution(s)  of the multilevel hidden Markov model — prior_emiss_cat • mHMMbayes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying informative hyper-prior on the categorical emission distribution(s)  of the multilevel hidden Markov model — prior_emiss_cat"><meta property="og:description" content="prior_emiss_cat provides a framework to manually specify an informative
hyper-prior on the categorical emission distribution(s), and creates an object
of class mHMM_prior_emiss used by the function mHMM. Note that the
hyper-prior distribution on the categorical emission probabilities are on the
intercepts (and, if subject level covariates are used, regression
coefficients) of the Multinomial logit model used to accommodate the
multilevel framework of the data, instead of on the probabilities directly.
The set of hyper-prior distributions consists of a multivariate Normal
hyper-prior distribution on the vector of means (i.e., intercepts and
regression coefficients), and an Inverse Wishart hyper-prior distribution on
the covariance matrix."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mHMMbayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/online_only/get_started.html">Getting started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and data</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/online_only/tutorial-mhmm.html">Tutorial mHMM</a>
    <a class="dropdown-item" href="../articles/online_only/estimation-mhmm.html">Estimation of mHMM</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/emmekeaarts/mHMMbayes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specifying informative hyper-prior on the categorical emission distribution(s)  of the multilevel hidden Markov model</h1>
      <small class="dont-index">Source: <a href="https://github.com/emmekeaarts/mHMMbayes/blob/HEAD/R/prior_emiss_cat.R" class="external-link"><code>R/prior_emiss_cat.R</code></a></small>
      <div class="d-none name"><code>prior_emiss_cat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>prior_emiss_cat</code> provides a framework to manually specify an informative
hyper-prior on the categorical emission distribution(s), and creates an object
of class <code>mHMM_prior_emiss</code> used by the function <code>mHMM</code>. Note that the
hyper-prior distribution on the categorical emission probabilities are on the
intercepts (and, if subject level covariates are used, regression
coefficients) of the Multinomial logit model used to accommodate the
multilevel framework of the data, instead of on the probabilities directly.
The set of hyper-prior distributions consists of a multivariate Normal
hyper-prior distribution on the vector of means (i.e., intercepts and
regression coefficients), and an Inverse Wishart hyper-prior distribution on
the covariance matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prior_emiss_cat</span><span class="op">(</span></span>
<span>  <span class="va">gen</span>,</span>
<span>  <span class="va">emiss_mu0</span>,</span>
<span>  emiss_K0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  emiss_nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  emiss_V <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_xx_emiss <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gen</dt>
<dd><p>List containing the following elements denoting the general model
properties:</p><ul><li><p><code>n_dep</code>: numeric vector with length 1 denoting the
number of dependent variables</p></li>
<li><p><code>q_emiss</code>: numeric vector with length <code>n_dep</code> denoting the
number of observed categories for the categorical emission distribution
for each of the dependent variables.</p></li>
</ul></dd>


<dt>emiss_mu0</dt>
<dd><p>A list of lists: <code>emiss_mu0</code> contains <code>n_dep</code>
lists, i.e., one list for each dependent variable <code>k</code>. Each list
<code>k</code> contains <code>m</code> matrices; one matrix for each set of emission
probabilities within a state. The matrices contain the hypothesized
hyper-prior mean values of the intercepts of the Multinomial logit model on
the categorical emission probabilities. Hence, each matrix consists of one
row (when not including covariates in the model) and <code>q_emiss[k]</code> - 1
columns. If covariates are used, the number of rows in each matrix in the
list is equal to 1 + n_xx (i.e., the first row corresponds to the
hyper-prior mean values of the intercepts, the subsequent rows correspond
to the hyper-prior mean values of the regression coefficients connected to
each of the covariates).</p></dd>


<dt>emiss_K0</dt>
<dd><p>Optional list containing <code>n_dep</code> elements corresponding
to each dependent variable <code>k</code>. Each element <code>k</code> is a
numeric vector with length 1 (when no covariates are used) denoting the
number of hypothetical prior subjects on which the set of hyper-prior mean
intercepts specified in <code>emiss_mu0</code> are based. When covariates are
used: each element is a numeric vector with length 1 + n_xx denoting the
number of hypothetical prior subjects on which the set of intercepts (first
value) and set of regression coefficients (subsequent values) are based.</p></dd>


<dt>emiss_nu</dt>
<dd><p>Optional list containing <code>n_dep</code> elements corresponding
to each dependent variable <code>k</code>. Each element <code>k</code> is
a numeric vector with length 1 denoting the degrees of freedom of the
hyper-prior Inverse Wishart distribution on the covariance of the
Multinomial logit intercepts.</p></dd>


<dt>emiss_V</dt>
<dd><p>Optional list containing <code>n_dep</code> elements corresponding
to each dependent variable <code>k</code>, where each element <code>k</code> is a
matrix of <code>q_emiss[k]</code> - 1 by <code>q_emiss[k]</code> - 1 containing the
variance-covariance of the hyper-prior Inverse Wishart distribution on the
covariance of the Multinomial logit intercepts.</p></dd>


<dt>n_xx_emiss</dt>
<dd><p>Optional numeric vector with length <code>n_dep</code> denoting
the number of (level 2) covariates used to predict the emission
distribution of each of the dependent variables <code>k</code>. When omitted, the
model assumes no covariates are used to predict the emission
distribution(s).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>prior_emiss_cat</code> returns an object of class <code>mHMM_prior_emiss</code>,
  containing informative hyper-prior values for the categorical emission
  distribution(s) of the multilevel hidden Markov model. The object is
  specifically created and formatted for use by the function <code>mHMM</code>,
  and thoroughly checked for correct input dimensions.
  The object contains the following components:</p>
<p></p>
<dl><dt><code>gen</code></dt>
<dd><p>A list containing the elements <code>m</code>, <code>n_dep</code>,
  and <code>q_emiss</code>, used for checking equivalent general model properties
  specified under <code>prior_emiss_cat</code> and <code>mHMM</code>.</p></dd>

  <dt><code>emiss_mu0</code></dt>
<dd><p>A list of lists containing the hypothesized
  hyper-prior mean values of the intercepts of the Multinomial logit model on
  the categorical emission probabilities.</p></dd>

  <dt><code>emiss_K0</code></dt>
<dd><p>A list containing <code>n_dep</code> elements denoting the
  number of hypothetical prior subjects on which the set of hyper-prior mean
  intercepts specified in <code>emiss_mu0</code> are based.</p></dd>

  <dt><code>emiss_nu</code></dt>
<dd><p>A list containing <code>n_dep</code> elements denoting the
  degrees of freedom of the hyper-prior Inverse Wishart distribution on
  the covariance of the Multinomial logit intercepts.</p></dd>

  <dt><code>emiss_V</code></dt>
<dd><p>A list containing <code>n_dep</code> elements containing
  the variance-covariance of the hyper-prior Inverse Wishart distribution on
  the covariance of the Multinomial logit intercepts.</p></dd>

  <dt><code>n_xx_emiss</code></dt>
<dd><p>A numeric vector denoting the number of (level 2)
  covariates used to predict the emission distribution of each of the
  dependent variables. When no covariates are used, <code>n_xx_emiss</code> equals
  <code>NULL</code>.</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Estimation of the mHMM proceeds within a Bayesian context, hence a
hyper-prior distribution has to be defined for the group level parameters.
Default, non-informative priors are used unless specified otherwise by the
user. For each dependent variable, each row of the categorical emission
probability matrix (i.e., the probability to observe each category (columns)
within each of the states (rows)) has its own set of Multinomial logit
intercepts, which are assumed to follow a multivariate normal distribution.
Hence, the hyper-prior distributions for the intercepts consists of a
multivariate Normal hyper-prior distribution on the vector of means, and an
Inverse Wishart hyper-prior distribution on the covariance matrix. Note that
only the general model properties (number of states <code>m</code>, number of
dependent variables <code>n_dep</code>, and number of observed categories for each
dependent variable <code>q_emiss</code>) and values of the hypothesized hyper-prior
mean values of the Multinomial logit intercepts have to be specified by the
user, default values are available for all other hyper-prior distribution
parameters.</p>
<p>Given that the hyper-priors are specified on the intercepts of the Multinomial
logit model intercepts instead of on the categorical emission
probabilities directly, specifying a hyper-prior can seem rather
daunting. However, see the function <code><a href="prob_to_int.html">prob_to_int</a></code> and
<code><a href="int_to_prob.html">int_to_prob</a></code> for translating probabilities to a set of
Multinomial logit intercepts and vice versa.</p>
<p>Note that <code>emiss_K0</code>, <code>emiss_nu</code> and <code>emiss_V</code> are assumed
equal over the states.  When the hyper-prior values for <code>emiss_K0</code>,
<code>emiss_nu</code> and <code>emiss_V</code> are not manually specified, the default
values are as follows. <code>emiss_K0</code> set to 1, <code>emiss_nu</code> set to 3 +
<code>q_emiss[k]</code> - 1, and the diagonal of <code>gamma_V</code> (i.e., the
variance) set to 3 + <code>q_emiss[k]</code> - 1 and the off-diagonal elements
(i.e., the covariance) set to 0. In addition, when no manual values for the
hyper-prior on the categorical emission distribution are specified at all
(that is, the function <code>prior_emiss_cat</code> is not used), all elements of
the matrices contained in <code>emiss_mu0</code> are set to 0 in the function
<code>mHMM</code>.</p>
<p>Note that in case covariates are specified, the hyper-prior parameter values
of the inverse Wishart distribution on the covariance matrix remain
unchanged, as the estimates of the regression coefficients for the covariates
are fixed over subjects.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="prior_gamma.html">prior_gamma</a></code> for manually specifying an informative
  hyper-prior on the transition probability matrix gamma,
  <code><a href="prob_to_int.html">prob_to_int</a></code> for transforming a set of probabilities to a set
  of Multinomial logit regression intercepts, and <code><a href="mHMM.html">mHMM</a></code> for
  fitting a multilevel hidden Markov model.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###### Example using package example data, see ?nonverbal</span></span></span>
<span class="r-in"><span><span class="co"># specifying general model properties:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n_dep</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">q_emiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># hypothesized mean emission probabilities</span></span></span>
<span class="r-in"><span><span class="va">prior_prob_emiss_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.80</span>, <span class="fl">0.10</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.80</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.40</span>, <span class="fl">0.40</span>, <span class="fl">0.20</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                    nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing patient,</span></span></span>
<span class="r-in"><span>                                    <span class="co"># prior belief: state 1 - much talking, state 2 -</span></span></span>
<span class="r-in"><span>                                    <span class="co"># no talking, state 3 - mixed</span></span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.70</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.30</span>, <span class="fl">0.70</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.30</span>, <span class="fl">0.70</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                                    ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="co"># looking patient</span></span></span>
<span class="r-in"><span>                                    <span class="co"># prior belief: all 3 states show frequent looking</span></span></span>
<span class="r-in"><span>                                    <span class="co"># behavior</span></span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.10</span>, <span class="fl">0.80</span>, <span class="fl">0.10</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.40</span>, <span class="fl">0.40</span>, <span class="fl">0.20</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                    nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing therapist</span></span></span>
<span class="r-in"><span>                                    <span class="co"># prior belief: state 1 - no talking, state 2 -</span></span></span>
<span class="r-in"><span>                                    <span class="co"># frequent talking, state 3 - mixed</span></span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.70</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.30</span>, <span class="fl">0.70</span>,</span></span>
<span class="r-in"><span>                                      <span class="fl">0.30</span>, <span class="fl">0.70</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                                    ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># looking therapist</span></span></span>
<span class="r-in"><span>                                    <span class="co"># prior belief: all 3 states show frequent looking</span></span></span>
<span class="r-in"><span>                                    <span class="co"># behavior</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using the function prob_to_int to obtain intercept values for the above specified</span></span></span>
<span class="r-in"><span><span class="co"># categorical emission distributions</span></span></span>
<span class="r-in"><span><span class="va">prior_int_emiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">prior_prob_emiss_cat</span>, <span class="va">prob_to_int</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="va">m</span><span class="op">)</span><span class="op">)</span>, <span class="va">n_dep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_dep</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">emiss_mu0</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">prior_int_emiss</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">emiss_K0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="va">n_dep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">manual_prior_emiss</span> <span class="op">&lt;-</span> <span class="fu">prior_emiss_cat</span><span class="op">(</span>gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  emiss_mu0 <span class="op">=</span> <span class="va">emiss_mu0</span>, emiss_K0 <span class="op">=</span> <span class="va">emiss_K0</span>,</span></span>
<span class="r-in"><span>                                  emiss_nu <span class="op">=</span> <span class="va">emiss_nu</span>, emiss_V <span class="op">=</span> <span class="va">emiss_V</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using the informative hyper-prior in a model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specifying starting values</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.1</span></span></span>
<span class="r-in"><span><span class="va">start_EM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.55</span>, <span class="fl">0.45</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="co"># looking patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.55</span>, <span class="fl">0.45</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing therapist</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># looking therapist</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that for reasons of running time, J is set at a ridiculous low value.</span></span></span>
<span class="r-in"><span><span class="co"># One would typically use a number of iterations J of at least 1000,</span></span></span>
<span class="r-in"><span><span class="co"># and a burn_in of 200.</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">out_3st_infemiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="mHMM.html">mHMM</a></span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>,</span></span>
<span class="r-in"><span>                    gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    emiss_hyp_prior <span class="op">=</span> <span class="va">manual_prior_emiss</span>,</span></span>
<span class="r-in"><span>                    mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">11</span>, burn_in <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:06</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="co"># executable in &lt; 5 sec together with the examples above</span></span></span>
<span class="r-in"><span><span class="va">out_3st_infemiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="mHMM.html">mHMM</a></span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>,</span></span>
<span class="r-in"><span>                    gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    emiss_hyp_prior <span class="op">=</span> <span class="va">manual_prior_emiss</span>,</span></span>
<span class="r-in"><span>                    mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">6</span>, burn_in <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:03</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out_3st_infemiss</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 iterations used in the MCMC algorithm with a burn in of 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average Log likelihood over all subjects: -1552.213 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average AIC over all subjects: 3152.426 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of states used: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of dependent variables used: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_3st_infemiss</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State transition probability matrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              To state 1 To state 2 To state 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 1      0.901      0.028      0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 2      0.018      0.928      0.054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 3      0.190      0.175      0.635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Emission distribution for each of the dependent variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.008      0.970      0.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.824      0.032      0.143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.255      0.670      0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.231      0.769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.065      0.935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.187      0.813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.881      0.034      0.085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.013      0.975      0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.271      0.685      0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.035      0.965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.204      0.796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.128      0.872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="xxx">Emmeke Aarts</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

