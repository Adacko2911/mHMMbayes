<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="pd_RW_emiss_cat provides a framework to manually specify the
settings of the proposal distribution of the random walk (RW) Metropolis
sampler of the emission distribution(s) of the multilevel hidden Markov
model, and creates on object of the class mHMM_pdRW_emiss. The RW
metropolis sampler is used for sampling the subject level parameter estimates
relating to the emission distributions of the dependent variables k,
that is, the Multinomial logistic regression intercepts."><title>Proposal distribution settings RW Metropolis sampler for mHMM categorical emission distribution(s) — pd_RW_emiss_cat • mHMMbayes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Proposal distribution settings RW Metropolis sampler for mHMM categorical emission distribution(s) — pd_RW_emiss_cat"><meta property="og:description" content="pd_RW_emiss_cat provides a framework to manually specify the
settings of the proposal distribution of the random walk (RW) Metropolis
sampler of the emission distribution(s) of the multilevel hidden Markov
model, and creates on object of the class mHMM_pdRW_emiss. The RW
metropolis sampler is used for sampling the subject level parameter estimates
relating to the emission distributions of the dependent variables k,
that is, the Multinomial logistic regression intercepts."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mHMMbayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/online_only/get_started.html">Getting started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and data</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/online_only/tutorial-mhmm.html">Tutorial mHMM</a>
    <a class="dropdown-item" href="../articles/online_only/estimation-mhmm.html">Estimation of mHMM</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/emmekeaarts/mHMMbayes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Proposal distribution settings RW Metropolis sampler for mHMM categorical emission distribution(s)</h1>
      <small class="dont-index">Source: <a href="https://github.com/emmekeaarts/mHMMbayes/blob/HEAD/R/pd_RW_emiss_cat.R" class="external-link"><code>R/pd_RW_emiss_cat.R</code></a></small>
      <div class="d-none name"><code>pd_RW_emiss_cat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>pd_RW_emiss_cat</code> provides a framework to manually specify the
settings of the proposal distribution of the random walk (RW) Metropolis
sampler of the emission distribution(s) of the multilevel hidden Markov
model, and creates on object of the class <code>mHMM_pdRW_emiss</code>. The RW
metropolis sampler is used for sampling the subject level parameter estimates
relating to the emission distributions of the dependent variables <code>k</code>,
that is, the Multinomial logistic regression intercepts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pd_RW_emiss_cat</span><span class="op">(</span><span class="va">gen</span>, <span class="va">emiss_int_mle0</span>, <span class="va">emiss_scalar</span>, <span class="va">emiss_w</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gen</dt>
<dd><p>List containing the following elements denoting the general model
properties:</p><ul><li><p><code>n_dep</code>: numeric vector with length 1 denoting the
number of dependent variables</p></li>
<li><p><code>q_emiss</code>: numeric vector with length <code>n_dep</code> denoting the
number of observed categories for the categorical emission distribution
for each of the dependent variables.</p></li>
</ul></dd>


<dt>emiss_int_mle0</dt>
<dd><p>A list containing <code>n_dep</code> elements corresponding
to each of the dependent variables <code>k</code>, where each element is a matrix
with <code>m</code> rows and <code>q_emiss[k]</code> - 1 columns denoting the starting
values for the maximum likelihood (ML) estimates of the Multinomial logit
regression intercepts of the emission distribution(s). ML parameters to be
estimated are based on the pooled data (data over all subjects).</p></dd>


<dt>emiss_scalar</dt>
<dd><p>A list containing <code>n_dep</code> elements
corresponding to each of the dependent variables, where each element is a
numeric vector with length 1 denoting the scale factor <code>s</code>. That is,
the scale of the proposal distribution is composed of a covariance matrix
Sigma, which is then tuned by multiplying it by a scaling factor <code>s</code>^2.</p></dd>


<dt>emiss_w</dt>
<dd><p>A list containing <code>n_dep</code> elements corresponding
to each of the dependent variables, where each element is a numeric vector
with length 1 denoting the weight for the overall log likelihood (i.e., log
likelihood based on the pooled data over all subjects) in the fractional
likelihood.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>pd_RW_emiss_cat</code> returns an object of class</p>
<p></p>
<p><code>mHMM_pdRW_emiss</code>, containing settings of the proposal distribution of
  the random walk (RW) Metropolis sampler on the categorical emission
  distribution(s) of the multilevel hidden Markov model. The object is
  specifically created and formatted for use by the function <code>mHMM</code>, and
  checked for correct input dimensions. The object contains the following
  components:</p>
<p></p>
<dl><dt><code>gen</code></dt>
<dd><p>A list containing the elements <code>m</code>, <code>n_dep</code>,
  and <code>q_emiss</code>, used for checking equivalent general model properties
  specified under <code>pd_RW_emiss_cat</code> and <code>mHMM</code>.</p></dd>

  <dt><code>emiss_int_mle0</code></dt>
<dd><p>A list containing <code>n_dep</code> elements, where
  each element is a matrix  containing the starting values for the maximum
  likelihood (ML) estimates of the Multinomial logit regression intercepts of
  the emission distribution(s).</p></dd>

  <dt><code>emiss_scalar</code></dt>
<dd><p>A list containing <code>n_dep</code> elements denoting
  the scale factor <code>s</code> of the proposal distribution.</p></dd>

 <dt><code>emiss_w</code></dt>
<dd><p>A list containing <code>n_dep</code> elements denoting
 denoting the weight for the overall log likelihood in the fractional
 likelihood.</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When no manual values for the settings of the proposal distribution of the
random walk (RW) Metropolis sampler are specified at all (that is, the
function <code>pd_RW_emiss_cat</code> is not used), all elements in
<code>emiss_int_mle0</code> set to 0, <code>emiss_scalar</code> set to 2.93 /
sqrt(<code>q_emiss[k]</code> - 1), and <code>emiss_w</code> set to 0.1. See the section
<em>Scaling the proposal distribution of the RW Metropolis sampler</em> in
<code><a href="../articles/estimation-mhmm.html">vignette("estimation-mhmm")</a></code> for details.</p>
<p>Within the function <code>mHMM</code>, the acceptance rate of the RW metropolis
sampler relating to the emission distribution(s) can be tracked using the
output parameter <code>emiss_naccept</code>. An acceptance rate of about 23% is
considered optimal when many parameters are being updated at once (Gelman,
Carlin, Stern &amp; Rubin, 2014).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gelman A, Carlin JB, Stern HS, Rubin DB (2014).
<em>Bayesian Data Analysis vol. 2</em>.
Taylor &amp; Francis.</p>
<p>Rossi PE, Allenby GM, McCulloch R (2012).
<em>Bayesian statistics and marketing</em>.
John Wiley &amp; Sons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###### Example using package example data, see ?nonverbal</span></span></span>
<span class="r-in"><span><span class="co"># specifying general model properties:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n_dep</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">q_emiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specifying manual values for RW metropolis sampler on emission distribtutions</span></span></span>
<span class="r-in"><span><span class="va">emiss_int_mle0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>,  <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                <span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">2</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">2</span>,  <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                 <span class="fl">2</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_scalar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emiss_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>, <span class="va">n_dep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">manual_emiss_sampler</span> <span class="op">&lt;-</span> <span class="fu">pd_RW_emiss_cat</span><span class="op">(</span>gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                        emiss_int_mle0 <span class="op">=</span> <span class="va">emiss_int_mle0</span>,</span></span>
<span class="r-in"><span>                                        emiss_scalar <span class="op">=</span> <span class="va">emiss_scalar</span>,</span></span>
<span class="r-in"><span>                                        emiss_w <span class="op">=</span> <span class="va">emiss_w</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specifying starting values</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start_TM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.1</span></span></span>
<span class="r-in"><span><span class="va">start_EM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.55</span>, <span class="fl">0.45</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="co"># looking patient</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.05</span>, <span class="fl">0.90</span>, <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.55</span>, <span class="fl">0.45</span>, <span class="fl">0.05</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># vocalizing therapist</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        ncol <span class="op">=</span> <span class="va">q_emiss</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># looking therapist</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that for reasons of running time, J is set at a ridiculous low value.</span></span></span>
<span class="r-in"><span><span class="co"># One would typically use a number of iterations J of at least 1000,</span></span></span>
<span class="r-in"><span><span class="co"># and a burn_in of 200.</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">out_3st_RWemiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="mHMM.html">mHMM</a></span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>,</span></span>
<span class="r-in"><span>                         gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         emiss_sampler <span class="op">=</span> <span class="va">manual_emiss_sampler</span>,</span></span>
<span class="r-in"><span>                         mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">11</span>, burn_in <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:06</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="va">out_3st_RWemiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="mHMM.html">mHMM</a></span><span class="op">(</span>s_data <span class="op">=</span> <span class="va">nonverbal</span>,</span></span>
<span class="r-in"><span>                         gen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, n_dep <span class="op">=</span> <span class="va">n_dep</span>, q_emiss <span class="op">=</span> <span class="va">q_emiss</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         start_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">start_TM</span><span class="op">)</span>, <span class="va">start_EM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         emiss_sampler <span class="op">=</span> <span class="va">manual_emiss_sampler</span>,</span></span>
<span class="r-in"><span>                         mcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">6</span>, burn_in <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress of the Bayesian mHMM algorithm: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total time elapsed (hh:mm:ss): 00:00:03</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out_3st_RWemiss</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 iterations used in the MCMC algorithm with a burn in of 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average Log likelihood over all subjects: -1554.725 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average AIC over all subjects: 3157.449 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of states used: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of dependent variables used: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_3st_RWemiss</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State transition probability matrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              To state 1 To state 2 To state 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 1      0.870      0.040      0.090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 2      0.033      0.898      0.069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> From state 3      0.176      0.157      0.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Emission distribution for each of the dependent variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (at the group level): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.006      0.971      0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.818      0.032      0.150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.258      0.669      0.072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.247      0.753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.104      0.895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.238      0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_vocalizing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2 Category 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.813      0.053      0.133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.024      0.950      0.026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.265      0.663      0.072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $t_looking</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Category 1 Category 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1      0.042      0.958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2      0.238      0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 3      0.178      0.823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># checking acceptance rate (for illustrative purposes, in the example,</span></span></span>
<span class="r-in"><span><span class="co"># J is too low for getting a fair indication)</span></span></span>
<span class="r-in"><span><span class="va">div_J</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">J</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="va">J</span></span></span>
<span class="r-in"><span><span class="va">J_it</span> <span class="op">&lt;-</span> <span class="fl">11</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># accept/reject starts at iteration 2 of MCMC algorithm</span></span></span>
<span class="r-in"><span><span class="va">RW_emiss_accept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">out_3st_RWemiss</span><span class="op">$</span><span class="va">emiss_naccept</span>, <span class="va">div_J</span>, <span class="va">J_it</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># average acceptance rate over all subjects per parameter</span></span></span>
<span class="r-in"><span><span class="co"># rows represent each of the n_dep dependent variables, columns represent the m states</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">RW_emiss_accept</span>, <span class="va">apply</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, <span class="va">mean</span>, simplyfy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.34 0.19 0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.20 0.34 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.24 0.35 0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.37 0.19 0.28</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="xxx">Emmeke Aarts</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

